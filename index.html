<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Emoji Code Mood üé≠ - Version S√©curis√©e</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #3ECF8E 0%, #2B7EC8 100%);
            min-height: 100vh;
            padding: 20px;
            color: #333;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
        }
        
        .header {
            text-align: center;
            background: white;
            padding: 30px;
            border-radius: 20px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
            margin-bottom: 30px;
        }
        
        .header h1 {
            color: #3ECF8E;
            font-size: 2.5em;
            margin-bottom: 10px;
        }
        
        .header p {
            color: #666;
            font-size: 1.1em;
            margin-bottom: 20px;
        }
        
        .security-badge {
            display: inline-flex;
            align-items: center;
            background: #28a745;
            color: white;
            padding: 5px 12px;
            border-radius: 15px;
            font-size: 0.9em;
            font-weight: 600;
            margin-bottom: 15px;
        }
        
        .mode-indicator {
            padding: 10px 15px;
            border-radius: 8px;
            margin-bottom: 15px;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .mode-demo {
            background: #e3f2fd;
            color: #1976d2;
            border: 1px solid #bbdefb;
        }
        
        .mode-collaborative {
            background: #e8f5e8;
            color: #2e7d32;
            border: 1px solid #c8e6c9;
        }
        
        .mode-config {
            background: #fff3e0;
            color: #f57c00;
            border: 1px solid #ffcc02;
        }
        
        .stats {
            display: flex;
            justify-content: center;
            gap: 30px;
            margin-top: 20px;
        }
        
        .stat-item {
            background: #f8fffc;
            padding: 15px 25px;
            border-radius: 10px;
            text-align: center;
        }
        
        .stat-number {
            font-size: 2em;
            font-weight: bold;
            color: #3ECF8E;
        }
        
        .stat-label {
            color: #666;
            margin-top: 5px;
        }
        
        .main-content {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 30px;
            margin-bottom: 30px;
        }
        
        .form-section, .display-section {
            background: white;
            padding: 30px;
            border-radius: 20px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
        }
        
        .form-section h2 {
            color: #3ECF8E;
            margin-bottom: 20px;
            font-size: 1.8em;
        }
        
        .config-panel {
            background: #f8f9fa;
            border: 2px dashed #dee2e6;
            border-radius: 10px;
            padding: 20px;
            margin-bottom: 20px;
            text-align: center;
        }
        
        .config-panel h3 {
            color: #6c757d;
            margin-bottom: 10px;
        }
        
        .config-button {
            background: #ffc107;
            color: #333;
            border: none;
            padding: 10px 20px;
            border-radius: 8px;
            font-weight: 600;
            cursor: pointer;
            margin: 5px;
            transition: transform 0.2s;
        }
        
        .config-button:hover {
            transform: translateY(-1px);
        }
        
        .form-group {
            margin-bottom: 20px;
        }
        
        label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: #333;
        }
        
        input, select, textarea {
            width: 100%;
            padding: 12px;
            border: 2px solid #e1e8ed;
            border-radius: 10px;
            font-size: 16px;
            transition: border-color 0.3s ease;
        }
        
        input:focus, select:focus, textarea:focus {
            outline: none;
            border-color: #3ECF8E;
        }
        
        .emoji-selector {
            display: grid;
            grid-template-columns: repeat(6, 1fr);
            gap: 8px;
            margin-bottom: 15px;
            max-height: 300px;
            overflow-y: auto;
            padding: 10px;
            border: 2px solid #e1e8ed;
            border-radius: 10px;
            background: #fafbfc;
        }
        
        .emoji-btn {
            padding: 12px;
            border: 2px solid #e1e8ed;
            background: white;
            border-radius: 8px;
            font-size: 1.8em;
            cursor: pointer;
            transition: all 0.3s ease;
            min-height: 50px;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .emoji-btn:hover {
            transform: scale(1.1);
            border-color: #3ECF8E;
        }
        
        .emoji-btn.selected {
            border-color: #3ECF8E;
            background: #f8fffc;
            transform: scale(1.1);
        }
        
        .submit-btn {
            background: linear-gradient(135deg, #3ECF8E 0%, #2B7EC8 100%);
            color: white;
            border: none;
            padding: 15px 30px;
            border-radius: 10px;
            font-size: 1.1em;
            font-weight: 600;
            cursor: pointer;
            transition: transform 0.3s ease;
            width: 100%;
        }
        
        .submit-btn:hover {
            transform: translateY(-2px);
        }
        
        .submit-btn:disabled {
            opacity: 0.6;
            cursor: not-allowed;
            transform: none;
        }
        
        .mood-list {
            max-height: 600px;
            overflow-y: auto;
        }
        
        .mood-item {
            background: #f8fffc;
            padding: 15px;
            border-radius: 10px;
            margin-bottom: 15px;
            border-left: 4px solid #3ECF8E;
            animation: slideIn 0.3s ease;
        }
        
        @keyframes slideIn {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        .mood-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
        }
        
        .student-name {
            font-weight: 600;
            color: #333;
        }
        
        .timestamp {
            font-size: 0.9em;
            color: #666;
        }
        
        .code-display {
            background: #2d3748;
            color: #e2e8f0;
            padding: 15px;
            border-radius: 8px;
            font-family: 'Courier New', monospace;
            margin-top: 10px;
            position: relative;
        }
        
        .language-tag {
            position: absolute;
            top: 5px;
            right: 10px;
            background: #3ECF8E;
            color: white;
            padding: 2px 8px;
            border-radius: 4px;
            font-size: 0.8em;
        }
        
        .comment {
            color: #a0aec0;
        }
        
        .teacher-controls {
            background: white;
            padding: 20px;
            border-radius: 20px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
            text-align: center;
        }
        
        .control-btn {
            background: #e53e3e;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 8px;
            margin: 0 10px;
            cursor: pointer;
            font-weight: 600;
            transition: transform 0.2s;
        }
        
        .control-btn:hover {
            transform: translateY(-1px);
        }
        
        .export-btn {
            background: #38a169;
        }
        
        .refresh-btn {
            background: #3182ce;
        }
        
        .config-modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.8);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 1000;
        }
        
        .config-modal-content {
            background: white;
            padding: 30px;
            border-radius: 15px;
            max-width: 500px;
            width: 90%;
            max-height: 80vh;
            overflow-y: auto;
        }
        
        .config-modal h3 {
            color: #3ECF8E;
            margin-bottom: 20px;
            text-align: center;
        }
        
        .config-option {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 15px;
            cursor: pointer;
            border: 2px solid transparent;
            transition: all 0.3s;
        }
        
        .config-option:hover {
            border-color: #3ECF8E;
            background: #f0fff4;
        }
        
        .config-option h4 {
            color: #333;
            margin-bottom: 10px;
        }
        
        .config-option p {
            color: #666;
            font-size: 0.9em;
            line-height: 1.4;
        }
        
        @media (max-width: 768px) {
            .main-content {
                grid-template-columns: 1fr;
            }
            
            .stats {
                flex-direction: column;
                align-items: center;
            }
            
            .emoji-selector {
                grid-template-columns: repeat(4, 1fr);
                max-height: 250px;
            }
            
            .emoji-btn {
                font-size: 1.5em;
                min-height: 45px;
                padding: 8px;
            }
            
            .config-modal-content {
                padding: 20px;
            }
        }
        
        .mood-visualization {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            justify-content: center;
            margin: 20px 0;
        }
        
        .mood-bubble {
            display: flex;
            align-items: center;
            background: #f8fffc;
            padding: 8px 15px;
            border-radius: 20px;
            font-size: 1.2em;
            border: 2px solid #e1e8ed;
        }
        
        .mood-count {
            margin-left: 8px;
            background: #3ECF8E;
            color: white;
            padding: 2px 8px;
            border-radius: 10px;
            font-size: 0.8em;
            font-weight: bold;
        }
        
        .loading {
            text-align: center;
            color: #666;
            padding: 20px;
        }
        
        .setup-guide {
            background: #e3f2fd;
            border: 1px solid #2196f3;
            border-radius: 10px;
            padding: 15px;
            margin-bottom: 20px;
        }
        
        .setup-guide h4 {
            color: #1976d2;
            margin-bottom: 10px;
        }
        
        .setup-guide a {
            color: #1976d2;
            font-weight: 600;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <div class="security-badge">
                üîê Version S√©curis√©e - Cl√©s API Prot√©g√©es
            </div>
            <h1>üé≠ Emoji Code Mood</h1>
            <p>Exprime ton humeur de rentr√©e avec une ligne de code !</p>
            
            <div class="mode-indicator" id="modeIndicator">
                <span id="modeIcon">‚öôÔ∏è</span>
                <span id="modeText">Initialisation...</span>
            </div>
            
            <div class="stats">
                <div class="stat-item">
                    <div class="stat-number" id="totalParticipants">0</div>
                    <div class="stat-label">Participants</div>
                </div>
                <div class="stat-item">
                    <div class="stat-number" id="moodVariety">0</div>
                    <div class="stat-label">Humeurs diff√©rentes</div>
                </div>
                <div class="stat-item">
                    <div class="stat-number" id="sessionTime">0</div>
                    <div class="stat-label">Minutes</div>
                </div>
            </div>
            
            <div class="mood-visualization" id="moodVisualization"></div>
        </div>
        
        <div class="main-content">
            <div class="form-section">
                <h2>üìù Code ton humeur</h2>
                
                <div class="config-panel" id="configPanel">
                    <h3>üîß Configuration</h3>
                    <p>Choisissez votre mode d'utilisation :</p>
                    <button class="config-button" onclick="showConfigModal()">‚öôÔ∏è Configurer</button>
                    <button class="config-button" onclick="useDemoMode()">üéÆ Mode D√©mo</button>
                </div>
                
                <div class="setup-guide" id="setupGuide" style="display: none;">
                    <h4>üìö Comment configurer Supabase ?</h4>
                    <p>
                        Pour utiliser la synchronisation temps r√©el : 
                        <a href="docs/supabase-setup.md" target="_blank">Guide Supabase</a> 
                        (5 minutes de configuration)
                    </p>
                </div>
                
                <form id="moodForm">
                    <div class="form-group">
                        <label for="studentName">Ton pr√©nom :</label>
                        <input type="text" id="studentName" required placeholder="Ex: Alex" maxlength="30">
                    </div>
                    
                    <div class="form-group">
                        <label>Choisis ton emoji :</label>
                        <div class="emoji-selector">
                            <!-- √ânergie et motivation -->
                            <button type="button" class="emoji-btn" data-emoji="üî•" title="Feu - Motiv√© √† fond">üî•</button>
                            <button type="button" class="emoji-btn" data-emoji="üí™" title="Muscle - Pr√™t au combat">üí™</button>
                            <button type="button" class="emoji-btn" data-emoji="üöÄ" title="Fus√©e - D√©collage imm√©diat">üöÄ</button>
                            <button type="button" class="emoji-btn" data-emoji="‚ö°" title="√âclair - √ânergie √©lectrique">‚ö°</button>
                            <button type="button" class="emoji-btn" data-emoji="üåü" title="√âtoile - Brillant aujourd'hui">üåü</button>
                            <button type="button" class="emoji-btn" data-emoji="‚ú®" title="√âtincelles - Magique">‚ú®</button>
                            
                            <!-- Fatigue et repos -->
                            <button type="button" class="emoji-btn" data-emoji="üò¥" title="Endormi - Mode sieste">üò¥</button>
                            <button type="button" class="emoji-btn" data-emoji="ü•±" title="B√¢illement - Fatigue">ü•±</button>
                            <button type="button" class="emoji-btn" data-emoji="‚òï" title="Caf√© - Besoin de caf√©ine">‚òï</button>
                            <button type="button" class="emoji-btn" data-emoji="üõå" title="Lit - Envie de dormir">üõå</button>
                            <button type="button" class="emoji-btn" data-emoji="üí§" title="ZZZ - Assoupi">üí§</button>
                            <button type="button" class="emoji-btn" data-emoji="üßü" title="Zombie - Mode survie">üßü</button>
                            
                            <!-- Stress et d√©fi -->
                            <button type="button" class="emoji-btn" data-emoji="ü§Ø" title="Explosion - Cerveau overload">ü§Ø</button>
                            <button type="button" class="emoji-btn" data-emoji="üò∞" title="Sueur - Stress intensif">üò∞</button>
                            <button type="button" class="emoji-btn" data-emoji="ü•µ" title="Chaud - Pression maximum">ü•µ</button>
                            <button type="button" class="emoji-btn" data-emoji="üòì" title="Goutte sueur - Inquiet">üòì</button>
                            <button type="button" class="emoji-btn" data-emoji="ü§™" title="Fou - Compl√®tement perch√©">ü§™</button>
                            <button type="button" class="emoji-btn" data-emoji="üôÉ" title="√Ä l'envers - Monde invers√©">üôÉ</button>
                            
                            <!-- Confiance et cool -->
                            <button type="button" class="emoji-btn" data-emoji="üòé" title="Cool - Ma√Ætre de l'univers">üòé</button>
                            <button type="button" class="emoji-btn" data-emoji="üòè" title="Smirk - Je sais tout">üòè</button>
                            <button type="button" class="emoji-btn" data-emoji="ü§ì" title="Geek - Mode intellectuel">ü§ì</button>
                            <button type="button" class="emoji-btn" data-emoji="üòå" title="Zen - Parfaitement serein">üòå</button>
                            <button type="button" class="emoji-btn" data-emoji="üòä" title="Sourire - Bonne humeur">üòä</button>
                            <button type="button" class="emoji-btn" data-emoji="üòÅ" title="Grand sourire - Joie">üòÅ</button>
                            
                            <!-- R√©flexion et questionnement -->
                            <button type="button" class="emoji-btn" data-emoji="ü§î" title="R√©flexion - En train de cogiter">ü§î</button>
                            <button type="button" class="emoji-btn" data-emoji="üßê" title="Monocle - Analyse pouss√©e">üßê</button>
                            <button type="button" class="emoji-btn" data-emoji="üëÄ" title="Yeux - J'observe tout">üëÄ</button>
                            <button type="button" class="emoji-btn" data-emoji="ü§®" title="Sourcil lev√© - Sceptique">ü§®</button>
                            <button type="button" class="emoji-btn" data-emoji="üò¨" title="Grimace - Pas tr√®s s√ªr">üò¨</button>
                            <button type="button" class="emoji-btn" data-emoji="üòï" title="D√©√ßu - Un peu triste">üòï</button>
                            
                            <!-- Humour et l√©g√®ret√© -->
                            <button type="button" class="emoji-btn" data-emoji="üòÖ" title="Rire nerveux - √áa va aller">üòÖ</button>
                            <button type="button" class="emoji-btn" data-emoji="üòÇ" title="Larmes de joie - Mort de rire">üòÇ</button>
                            <button type="button" class="emoji-btn" data-emoji="ü§£" title="Rire aux √©clats - Explosion">ü§£</button>
                            <button type="button" class="emoji-btn" data-emoji="üòÑ" title="Sourire √©clatant - Super content">üòÑ</button>
                            <button type="button" class="emoji-btn" data-emoji="ü•≥" title="F√™te - Mode c√©l√©bration">ü•≥</button>
                            <button type="button" class="emoji-btn" data-emoji="üéâ" title="Confettis - Party time">üéâ</button>
                            
                            <!-- Tech et geek -->
                            <button type="button" class="emoji-btn" data-emoji="üíª" title="Laptop - Mode d√©veloppeur">üíª</button>
                            <button type="button" class="emoji-btn" data-emoji="üñ•Ô∏è" title="Desktop - Workstation ready">üñ•Ô∏è</button>
                            <button type="button" class="emoji-btn" data-emoji="‚å®Ô∏è" title="Clavier - Ready to code">‚å®Ô∏è</button>
                            <button type="button" class="emoji-btn" data-emoji="ü§ñ" title="Robot - IA activated">ü§ñ</button>
                            <button type="button" class="emoji-btn" data-emoji="üëæ" title="Alien - Mode gaming">üëæ</button>
                            <button type="button" class="emoji-btn" data-emoji="üéØ" title="Cible - Objectif lock">üéØ</button>
                            
                            <!-- Sp√©ciaux -->
                            <button type="button" class="emoji-btn" data-emoji="ü¶Ñ" title="Licorne - Mood magique">ü¶Ñ</button>
                            <button type="button" class="emoji-btn" data-emoji="üé≠" title="Masques - Humeur th√©√¢trale">üé≠</button>
                            <button type="button" class="emoji-btn" data-emoji="üé≤" title="D√© - Mood al√©atoire">üé≤</button>
                            <button type="button" class="emoji-btn" data-emoji="üåà" title="Arc-en-ciel - Toutes les couleurs">üåà</button>
                            <button type="button" class="emoji-btn" data-emoji="üçï" title="Pizza - Mood gourmand">üçï</button>
                            <button type="button" class="emoji-btn" data-emoji="üé∏" title="Guitare - Rock'n'code">üé∏</button>
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label for="language">Langage de programmation :</label>
                        <select id="language" required>
                            <option value="">Choisis un langage</option>
                            <option value="javascript">JavaScript</option>
                            <option value="typescript">TypeScript</option>
                            <option value="python">Python</option>
                            <option value="java">Java</option>
                            <option value="csharp">C#</option>
                            <option value="php">PHP</option>
                            <option value="cpp">C++</option>
                            <option value="rust">Rust</option>
                            <option value="go">Go</option>
                        </select>
                    </div>
                    
                    <div class="form-group">
                        <label for="comment">Commentaire (optionnel) :</label>
                        <input type="text" id="comment" placeholder="Clique pour des id√©es..." list="commentSuggestions" maxlength="100">
                        <datalist id="commentSuggestions">
                            <option value="pr√™t pour attaquer les projets">
                            <option value="besoin d'un deuxi√®me caf√©">
                            <option value="cerveau en surchauffe">
                            <option value="easy peasy lemon squeezy">
                            <option value="mode r√©flexion intense">
                            <option value="je fais semblant de comprendre">
                            <option value="404 motivation not found">
                            <option value="mood de licorne cosmique">
                        </datalist>
                    </div>
                    
                    <button type="submit" class="submit-btn" id="submitBtn">Envoyer mon code mood ! üöÄ</button>
                </form>
            </div>
            
            <div class="display-section">
                <h2>üíª Mood Board de la classe</h2>
                <div class="mood-list" id="moodList">
                    <div class="loading">
                        <p>ü§ñ En attente de configuration...</p>
                    </div>
                </div>
            </div>
        </div>
        
        <div class="teacher-controls">
            <h3 style="margin-bottom: 15px; color: #3ECF8E;">üéì Contr√¥les enseignant</h3>
            <button class="control-btn refresh-btn" onclick="loadMoods()">üîÑ Actualiser</button>
            <button class="control-btn" onclick="clearAllMoods()">üóëÔ∏è Effacer tout</button>
            <button class="control-btn export-btn" onclick="exportMoods()">üìÑ Exporter CSV</button>
            <button class="control-btn export-btn" onclick="exportMoodsJSON()">üíæ Export JSON</button>
        </div>
    </div>

    <!-- Configuration Modal -->
    <div id="configModal" class="config-modal" style="display: none;">
        <div class="config-modal-content">
            <h3>‚öôÔ∏è Configuration Emoji Code Mood</h3>
            
            <div class="config-option" onclick="selectDemoMode()">
                <h4>üéÆ Mode D√©mo</h4>
                <p><strong>Recommand√© pour d√©buter</strong><br>
                ‚Ä¢ Fonctionne imm√©diatement<br>
                ‚Ä¢ Donn√©es stock√©es localement<br>
                ‚Ä¢ Id√©al pour tester l'application</p>
            </div>
            
            <div class="config-option" onclick="selectSupabaseMode()">
                <h4>‚ö° Mode Collaboratif (Supabase)</h4>
                <p><strong>Pour usage en classe</strong><br>
                ‚Ä¢ Synchronisation temps r√©el<br>
                ‚Ä¢ Tous les √©tudiants voient les r√©sultats<br>
                ‚Ä¢ Configuration requise (5 minutes)</p>
            </div>
            
            <div class="config-option" onclick="showSupabaseConfig()">
                <h4>üîß J'ai d√©j√† une configuration Supabase</h4>
                <p>Saisir directement mes cl√©s URL et API</p>
            </div>
            
            <div style="text-align: center; margin-top: 20px;">
                <button class="config-button" onclick="closeConfigModal()" style="background: #6c757d;">Annuler</button>
            </div>
        </div>
    </div>

    <!-- Supabase Config Form -->
    <div id="supabaseConfigForm" class="config-modal" style="display: none;">
        <div class="config-modal-content">
            <h3>üîß Configuration Supabase</h3>
            <form id="supabaseForm">
                <div class="form-group">
                    <label>URL Supabase :</label>
                    <input type="url" id="supabaseUrl" placeholder="https://xxx.supabase.co" required>
                </div>
                <div class="form-group">
                    <label>Cl√© Publique (anon) :</label>
                    <input type="text" id="supabaseKey" placeholder="eyJhbGciOiJIUzI1NiIs..." required>
                </div>
                <div style="display: flex; gap: 10px;">
                    <button type="submit" class="config-button" style="flex: 1;">Sauvegarder</button>
                    <button type="button" class="config-button" onclick="closeSupabaseConfig()" style="background: #6c757d; flex: 1;">Annuler</button>
                </div>
            </form>
            <div style="margin-top: 15px; font-size: 0.9em; color: #666;">
                <p>üîí <strong>S√©curit√© :</strong> Vos cl√©s sont stock√©es localement dans votre navigateur uniquement.</p>
                <p>üìö <a href="docs/supabase-setup.md" target="_blank">Guide de configuration Supabase</a></p>
            </div>
        </div>
    </div>

    <script type="module">
        // ========================================
        // CONFIGURATION S√âCURIS√âE
        // ========================================
        
        // Configuration par d√©faut (mode d√©mo)
        const DEFAULT_CONFIG = {
            mode: 'demo',
            supabaseUrl: null,
